--BY CATEGORY
SELECT category,
COUNT(*) TOTAL,
SUM(CASE WHEN closed_at_local is not null THEN 1 ELSE 0 END) CLOSED,
CAST(SUM(CASE WHEN closed_at_local is not null THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) * 100 PERCENT_CLOSED
FROM test
GROUP BY CATEGORY
ORDER BY PERCENT_CLOSED

--BY WARD
SELECT 
CAST(SUBSTRING(export_tagged_places from '\d+$') AS DECIMAL) WARD,
COUNT(*) TOTAL,
SUM(CASE WHEN closed_at_local is not null THEN 1 ELSE 0 END) CLOSED,
CAST(SUM(CASE WHEN closed_at_local is not null THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) * 100 PERCENT_CLOSED
FROM test
GROUP BY WARD
ORDER BY PERCENT_CLOSED
